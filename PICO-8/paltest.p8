pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()

 --underwater palette array
 local palarr={[0]=131,3,3,3,3,3,139,11,138,139,11,11,138,139,139,11}
  
 --apply secondary display pal
 pal(palarr,2)
 
 --palette tweak for surface
 pal(14,139,1)
 
 --turn on the sec disp pal
 poke(0x5f5f,0x10)
 
 --devkit for mouse
 poke(0x5f2d, 1)

end

function _draw()
 cls(12)
 map(0,0)
 
 --draw wavy surface
 for x=0,127 do
  pset(x,stat(33)+2+sin(x/8+time()*2)/2,14)
 end
end

function _update()
 --set bitmask to mouse y +2
 setwaterlevel(stat(33)+2)
end

function setwaterlevel(lvly)
 --renders everything below
 --lvly in secondary disp pal
 for i=0,15 do
  local mypoke,dif=0,lvly-i*8
  if dif<=0 then
   mypoke=0xff
  elseif dif<8 then
   mypoke=tonum(sub("0b11111111",1,10-dif)..sub("00000000",1,dif))
  end
  poke(0x5f70+i,mypoke)
 end
end


__gfx__
000000000bbbbbbbbbbbbbbbbbbbbbb00bbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbb3b3bbb3b3b3bbbbbbbbbbbbbb3bbb0000000000000000000000000000000000000000000000000007777777777000000000000000000000000000
00700700b3b434b3b4b434b3b3bb3b3bb3b34b3b0000000000000000000000000000000000000000900000000777777777777700000000000000000000000000
00077000393444343434443434b34393393443930000000000000000000000000000000000000000000000000777777777777770000000000000000000000000
000770000944444444444444443444900944449000000000000000000000000000000000000000aaaa0000000777777777777777000000000000000000000000
00700700094444444444444444444490094444900000000000000000000000000000000000000aaaaaa000000777777777777777000000000000000000000000
0000000009444444444444444444449009444490b000b0000b000b0b00000b0b0b000b000000aaaaaaaa00000777777777777777000000000000000000000000
0000000009444444444444444444449009444490b0b0b0b00b0b0b0b0b0b0b0b0b0b0b0b0090aaaaaaaa00000077777777777770000000000000000000000000
0000000009444444444444444444449009444490444444444444444400000000000000000000aaaaaaaa09000000333033333300000000000000000000000000
0000000009444444444444444444449009444490444444444444444400000555000000000000aaaaaaaa000000333333333b3b30000000000000000000000000
00000000094444444444444444444490094444904444444444444444000057775000000000000aaaaaa00000003333333333b333000000000000000000000000
000000000944444444444444444444900944449044444444444444440000577550000000000000aaaa0000000033b3b333b33333000000000000000000000000
000000000944444444444444444444900944449044444444444444440000577750000000000000000000000000333b3333333330000000000000000000000000
000000000944444444444444444444900944449044444444444444440000055500000000000000090000000000333333333b3b30000000000000000000000000
0000000009444444444444444444449009444490444444444444444400000050070000000000000000000000000333b3b333b300000000000000000000000000
00000000094444444444444444444490094444904444449999444444000005550500000000000000000000000003333b33333300000000000000000000000000
00000000094444444444444444444490094444904444443333444444000050505000000000000000000000000000033333330000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000500500000000000000000000000000000003334400000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000700500000000000000000000000000000004514400000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000500000000000000000000000000000004551400000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000005050000000000000000000000000000004454400000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000050005000000000000000000000000000004444400000000000000000000000000000
000000000099999999999999999999000099990044444444444444440b450b0b500b0b000000000000000000000b044b444b0000000000000000000000000000
000000000000000000000000000000000000000044444444444444440b4b0b0b4b0b0b0b00000000000000000b0b4b4b4b4b4b0b000000000000000000000000
000000000bbbbbbbbbbbbbbbbbbbbbb00bbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbb3b3bbb3b3b3bbbbbbbbbbbbbb3bbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000b3b434b3b4b434b3b3bb3b3bb3b34b3b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000393444343434443434b34393393443930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444344490094444900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999999999999999999900009999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000090a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000b0c0000191a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000b0c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000001718000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002728000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000102020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000012612121300001b1c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001261212121300002b2c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020226121212122502020202020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1112121212121212121212121212121300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1112121212121212121212121212121300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2122222222222222222222222222222300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
