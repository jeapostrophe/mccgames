pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()

 --underwater palette array
 local palarr={[0]=131,3,3,3,3,3,139,11,138,139,11,11,138,139,139,11}
  
 --apply secondary display pal
 pal(palarr,2)
 
 --palette tweak for surface
 pal(14,139,1)
 
 --turn on the sec disp pal
 poke(0x5f5f,0x10)
 
 --devkit for mouse
 poke(0x5f2d, 1)

end

function _draw()
 cls(12)
 map(0,0)
 
 --draw wavy surface
 for x=0,127 do
  pset(x,stat(33)+2+sin(x/8+time()*2)/2,14)
 end
end

function _update()
 --set bitmask to mouse y +2
 setwaterlevel(stat(33)+2)
end

function setwaterlevel(lvly)
 --renders everything below
 --lvly in secondary disp pal
 for i=0,15 do
  local mypoke,dif=0,lvly-i*8
  if dif<=0 then
   mypoke=0xff
  elseif dif<8 then
   mypoke=tonum(sub("0b11111111",1,10-dif)..sub("00000000",1,dif))
  end
  poke(0x5f70+i,mypoke)
 end
end


__gfx__
000000000bbbbbbbbbbbbbbbbbbbbbb00bbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbb3b3bbb3b3b3bbbbbbbbbbbbbb3bbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700b3b434b3b4b434b3b3bb3b3bb3b34b3b0000000000000000000000000000000000000000900000000000000000000000000000000000000000000000
00077000393444343434443434b34393393443930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000944444444444444443444900944449000000000000000000000000000000000000000aaaa0000000000000000000000000000000000000000000000
00700700094444444444444444444490094444900000000000000000000000000000000000000aaaaaa000000000000000000000000000000000000000000000
0000000009444444444444444444449009444490000b000b0b000b0b00000b0b0b000b000000aaaaaaaa00000000000000000000000000000000000000000000
00000000094444444444444444444490094444900b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0090aaaaaaaa00000000000000000000000000000000000000000000
0000000009444444444444444444449009444490444444444444444400000000000000000000aaaaaaaa09000000000000000000000000000000000000000000
0000000009444444444444444444449009444490444444444444444400000005550000000000aaaaaaaa00000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000577750000000000aaaaaa000000000000000000000000000000000000000000000
000000000944444444444444444444900944449044444444444444440000005775500000000000aaaa0000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000577750000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000055500000000000009000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000005007000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444449999444444000000055505000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444443333444444000000505050000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000005005000000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000007005000000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000005000000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000050500000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444904444444444444444000000500050000000000000000000000000000000000000000000000000000000000000
00000000009999999999999999999900009999004444444444444444000045000050000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004444444444444444000040000044000000000000000000000000000000000000000000000000000000000000
000000000bbbbbbbbbbbbbbbbbbbbbb00bbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbb3b3bbb3b3b3bbbbbbbbbbbbbb3bbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000b3b434b3b4b434b3b3bb3b3bb3b34b3b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000393444343434443434b34393393443930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444344490094444900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000094444444444444444444490094444900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999999999999999999900009999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000090a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000191a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000001718000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002728050800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000050102020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000005012612121300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0506070801261212121305060708050800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102020226121212122502020202020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1112121212121212121212121212121300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1112121212121212121212121212121300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2122222222222222222222222222222300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
